# PulseFlow
Control the speed of a cooling fan with your measured heart rate

## Description

**PulseFlow** is a small Arduino sketch that connects via BLE to a HR fitness sensor like those from Garmin, Wahoo and others. To cooling fan speed is connected to a PWM controlled AC dimmer. These dimmers can be sourced from marketplaces like AliExpress.

## Warning
BE AWARE THAT YOU'LL BE WORKING WITH DEADLY LIVE VOLTAGES. TAKE APPROPRIATE SAFETY MEASURES WHEN CONNECTING PARTS AND USING THE DEVICE YOU CREATED. 

## Limitations

+ Your HR sensor must allow for multiple connections as your trainer software/device will connect to the sensor too (Garmin HR-Dual sensor supports multiple connections)
+ Sensor pairing is hardcoded, see the sourcecode
+ Use a fan that has no electronic speed control of it's own.
+ The HR to fan speed mapping is hardcoded, see the sourcecode
+ The PWM signal is available on the D6 pin (Arduino numbering)
+ The PWM signal is not generated by analogWrite as the standard PWM frequency is too high for the AC Dimmer
+ **The PWM related code is specific for an Arduino NANO 33 BLE rev2** (but should be easy to adapt)
+ As the NANO is a 3.3V device the AC dimmer you use must be 3.3v tolerable/compatible (or add levelshifting)
+ Installing the various parts in a metal of shielded housing can influense the BLE RF signal

## Possible enhancements

+ Support different AC dimmer (not PWM controlled but zero crossing detect and delayed (gate) trigger)
+ Do away with hardcoded pairing
+ Create an UI (2 Line display and rotary encoder) for pairing, map settings. 
+ Alternate fan speed mapping methods (speed, power,...).
